<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"/>
		<meta content="width=device-width, initial-scale=1" name="viewport"/>
		<meta content="Explains how to use Sinobu and its API. " name="description"/>
		<link href="https://cdn.jsdelivr.net" rel="preconnect"/>
		<link href="https://fonts.googleapis.com" rel="preconnect"/>
		<link crossorigin="null" href="https://fonts.gstatic.com" rel="preconnect"/>
		<link as="style" fetchpriority="high" href="https://fonts.googleapis.com/css2?display=swap&#38;family=Inter" rel="preload"/>
		<link href="https://fonts.googleapis.com/css2?display=swap&#38;family=Inter" media="print" onload="this.media=&#39;all&#39;" rel="stylesheet"/>
		<link as="style" fetchpriority="high" href="https://fonts.googleapis.com/css2?display=swap&#38;family=Material+Icons" rel="preload"/>
		<link href="https://fonts.googleapis.com/css2?display=swap&#38;family=Material+Icons" media="print" onload="this.media=&#39;all&#39;" rel="stylesheet"/>
		<link as="style" fetchpriority="high" href="https://fonts.googleapis.com/css2?display=swap&#38;family=Vollkorn" rel="preload"/>
		<link href="https://fonts.googleapis.com/css2?display=swap&#38;family=Vollkorn" media="print" onload="this.media=&#39;all&#39;" rel="stylesheet"/>
		<title>Sinobu API</title>
		<base href="../"/>
		<script src="mimic.js" type="module"></script>
		<link href="https://cdn.jsdelivr.net/npm/ress@4.0.0/dist/ress.min.css" rel="stylesheet"/>
		<link href="main.css" rel="stylesheet"/>
	</head>
	<body class="L">
		<header class="M" date="2025-03-28" ver="4.7.0">
			<h1 class="k"><code>Sinobu</code></h1>
			<nav class="l"><a href="doc/doc.DocumentDoc.Introduction.html"><svg class="text A svg" viewBox="0 0 24 24">
						<use href="main.svg#text"/>
					</svg>Document</a><a href="api/" id="API"><svg class="package A svg" viewBox="0 0 24 24">
						<use href="main.svg#package"/>
					</svg>
				</a><a href="https://github.com/teletha/sinobu/discussions" id="Community" target="_blank"><svg class="user A svg" viewBox="0 0 24 24">
						<use href="main.svg#user"/>
					</svg>
				</a><a href="doc/changelog.html" id="Activity"><svg class="activity A svg" viewBox="0 0 24 24">
						<use href="main.svg#activity"/>
					</svg>
				</a><a href="https://github.com/teletha/sinobu" id="Repository" target="_blank"><svg class="github A svg" viewBox="0 0 24 24">
						<use href="main.svg#github"/>
					</svg>
				</a></nav>
			<div class="Y"><a aria-label="Change color scheme" id="theme"><svg class="sun A svg" viewBox="0 0 24 24">
						<use href="main.svg#sun"/>
					</svg><svg class="moon A svg" viewBox="0 0 24 24">
						<use href="main.svg#moon"/>
					</svg>
				</a></div>
		</header>
		<nav class="K"></nav>
		<article class="N" id="Article">
			<div class="W">
				<section class="B" id="doc.DocumentDoc.Managing_object_lifestyle.What_do_you_mean_by_lifestyle_">
					<header class="B g">
						<h2>What do you mean by lifestyle?</h2>
						<div class="s"><span class="perp R"><svg class="copy A svg" viewBox="0 0 24 24">
									<use href="main.svg#copy"/>
								</svg>
							</span><a class="tweet R"><svg class="twitter A svg" viewBox="0 0 24 24">
									<use href="main.svg#twitter"/>
								</svg>
							</a><a class="edit R" href="https://github.com/teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L110-L112"><svg class="edit A svg" viewBox="0 0 24 24">
									<use href="main.svg#edit"/>
								</svg>
							</a></div>
					</header><span class="B"><p>In Sinobu, lifestyle refers to the way an object is created and managed, corresponding to
the scope in terms of DI containers such as SpringFramework and Guice, but without the
process of registering with the container or destroying the object.</p></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.What_do_you_mean_by_lifestyle_.Creating_an_object">
					<header class="B d">
						<h3>Creating an object</h3>
					</header><span class="B"><p>In Java, it is common to use the new operator on the constructor to create a new
object. In many cases, this is sufficient, but in the following situations, it is a
bit insufficient.</p><ul>
							<li>To manage the number of objects to be created.</li>
							<li>To create objects associated with a specific context.</li>
							<li>To generate objects with complex dependencies.</li>
							<li>The type of the object to be generated is not statically determined.</li>
						</ul><p>While DI containers such as SpringFramework or Guice are commonly used to deal with
such problems, Sinobu comes with its own very simple DI container. The following code
shows the creation of an object using DI container.</p><pre class="lang-java"><code>void createObject() {
    class Tweet {
    }

    Tweet one = I.make(Tweet.class);
    assert one != null;
}</code></pre><p>As you can see from the above code, there is no actual container object; Sinobu has
only one global container in the JVM, and that object cannot be accessed directly. In
order to create an object from a container, we need to call <code><a aria-label="kiss.I" href="api/kiss.I.html#make(java.lang.Class)">I#make(Class)</a></code>.</p></span></section>
			</div>
			<div class="W">
				<section class="B" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle">
					<header class="B g">
						<h2>Defining lifestyle</h2>
						<div class="s"><span class="perp R"><svg class="copy A svg" viewBox="0 0 24 24">
									<use href="main.svg#copy"/>
								</svg>
							</span><a class="tweet R"><svg class="twitter A svg" viewBox="0 0 24 24">
									<use href="main.svg#twitter"/>
								</svg>
							</a><a class="edit R" href="https://github.com/teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L149-L158"><svg class="edit A svg" viewBox="0 0 24 24">
									<use href="main.svg#edit"/>
								</svg>
							</a></div>
					</header><span class="B"><p>In order to define a lifestyle, you need to implement Lifestyle interface. This interface
is essentially equivalent to Callable. It is called when container requests the specific
type. It makes the following 3 decisions:</p><ol>
							<li>Which class to instantiate actually.</li>
							<li>How to instantiate it.</li>
							<li>How to manage the instances.</li>
						</ol><p>Sinobu defines two lifestyles that are frequently used. One is the prototype pattern and
the other is the singleton pattern.</p></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Prototype">
					<header class="B d">
						<h3>Prototype</h3>
					</header><span class="B"><p>The default lifestyle is Prototype, it creates a new instance on demand. This is
applied automatically and you have to configure nothing.</p><pre class="lang-java"><code>public void prototype() {
    class Tweet {
    }

    Tweet one = I.make(Tweet.class);
    Tweet other = I.make(Tweet.class);
    assert one != other; // two different instances
}</code></pre></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Singleton">
					<header class="B d">
						<h3>Singleton</h3>
					</header><span class="B"><p>The other is the singleton lifestyle, which keeps a single instance in the JVM and
always returns it. This time, the lifestyle is applied with annotations when defining
the class.</p><pre class="lang-java"><code>public void singleton() {
    @Managed(Singleton.class)
    class Tweet {
    }

    Tweet one = I.make(Tweet.class);
    Tweet other = I.make(Tweet.class);
    assert one == other; // same instance
}</code></pre></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Custom_lifestyle">
					<header class="B d">
						<h3>Custom lifestyle</h3>
					</header><span class="B"><p>You can also implement lifestyles tied to specific contexts. Custom class requires to
implement the Lifestyle interface and receive the requested type in the constructor.
I&#39;m using <code><a aria-label="kiss.I" href="api/kiss.I.html#prototype(java.lang.Class)">I#prototype(Class)</a></code> here to make Dependency Injection work, but you
can use any instantiation technique.</p><pre class="lang-java"><code>class PerThread&#60;T&#62; implements Lifestyle&#60;T&#62; {
    private final ThreadLocal&#60;T&#62; local;

    PerThread(Class&#60;T&#62; requestedType) {
        // use sinobu&#39;s default instance builder
        Lifestyle&#60;T&#62; prototype = I.prototype(requestedType);

        // use ThreadLocal as contextual instance holder
        local = ThreadLocal.withInitial(prototype::get);
    }

    public T call() throws Exception {
        return local.get();
    }
}</code></pre><pre class="lang-java"><code>public void perThread() {
    @Managed(PerThread.class)
    class User {
    }

    // create contextual user
    User user1 = I.make(User.class);
    User user2 = I.make(User.class);
    assert user1 == user2; // same

    new Thread(() -&#62; {
        User user3 = I.make(User.class);
        assert user1 != user3; // different
    }).start();
}</code></pre></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Builtin_lifestyles">
					<header class="B d">
						<h3>Builtin lifestyles</h3>
					</header><span class="B"><p>Sinobu has built-in defined lifestyles for specific types.</p><ul>
							<li><code><a aria-label="java.util.List ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/List.html">List</a></code> - Create new instance each time. (<code><a aria-label="java.util.ArrayList ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/ArrayList.html">ArrayList</a></code>)</li>
							<li><code><a aria-label="java.util.Set ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Set.html">Set</a></code> - Create new instance each time. (<code><a aria-label="java.util.HashSet ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/HashSet.html">HashSet</a></code>)</li>
							<li><code><a aria-label="java.util.Map ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Map.html">Map</a></code> - Create new instance each time. (<code><a aria-label="java.util.HashMap ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/HashMap.html">HashMap</a></code>)</li>
							<li><code><a aria-label="java.util.Locale ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Locale.html">Locale</a></code> - Always returns the instance retrieved from
<code><a aria-label="java.util.Locale ðŸš€" href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/Locale.html#getDefault()">Locale#getDefault()</a></code>.</li>
						</ul></span></section>
			</div>
			<div class="W">
				<section class="B" id="doc.DocumentDoc.Managing_object_lifestyle.Applying_lifestyle">
					<header class="B g">
						<h2>Applying lifestyle</h2>
						<div class="s"><span class="perp R"><svg class="copy A svg" viewBox="0 0 24 24">
									<use href="main.svg#copy"/>
								</svg>
							</span><a class="tweet R"><svg class="twitter A svg" viewBox="0 0 24 24">
									<use href="main.svg#twitter"/>
								</svg>
							</a><a class="edit R" href="https://github.com/teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L240-L241"><svg class="edit A svg" viewBox="0 0 24 24">
									<use href="main.svg#edit"/>
								</svg>
							</a></div>
					</header><span class="B"><p>To apply a non-prototype lifestyle, you need to configure each class individually. There
are two ways to do this.</p></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.Applying_lifestyle.Use_Managed_annotation">
					<header class="B d">
						<h3>Use Managed annotation</h3>
					</header><span class="B"><p>One is to use <code><a aria-label="kiss.Managed" href="api/kiss.Managed.html">Managed</a></code> annotation. This method is useful if you want to apply
lifestyle to classes that are under your control.</p><pre class="lang-java"><code>@Managed(Singleton.class)
class UnderYourControl {
}</code></pre></span></section>
				<section class="B q" id="doc.DocumentDoc.Managing_object_lifestyle.Applying_lifestyle.Use_Lifestyle_extension">
					<header class="B d">
						<h3>Use Lifestyle extension</h3>
					</header><span class="B"><p>Another is to load the Lifestyle implementation. Sinobu has a wide variety of
extension points, and Lifestyle is one of them. This method is useful if you want to
apply lifestyle to classes that are not under your control.</p><pre class="lang-java"><code>class GlobalThreadPool implements Lifestyle&#60;Executor&#62; {

    private static final Executor pool = Executors.newCachedThreadPool();

    public Executor call() throws Exception {
        return pool;
    }
}</code></pre><pre class="lang-java"><code>public void loadLifestyle() {
    I.load(GlobalThreadPool.class);
}</code></pre></span></section>
			</div>
		</article>
		<aside class="O"></aside>
		<footer class="U"/>
	</body>
	<script src="root.js"></script>
	<script src="main.js" type="module"></script>
</html>